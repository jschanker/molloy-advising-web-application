<!doctype html>

<html>
	<head>
		<title>Molloy Advisement Web Application</title>
		<meta charset = "utf-8">
		<link type = "text/css" rel = "stylesheet" href = "advisement-styles.css">
        <script src = "allClasses.js"></script>
        <script src = "las-requirements.js"></script>
		<script src = "gened-requirements.js"></script>
		<script src = "courses.js"></script>
		<script src = "input-processor.js"></script>

	</head>
	<body>
		<h1>Molloy Advisement Web Application</h1>
		<form>
			<div id = "formTblContainer">
				<div id = "formTblRow">
					<div id = "leftPanelTblCell">
						<p><label for = "first-major-select">First Major:</label></p>
						<p>
							<SELECT name = "first-major" id = "first-major-select">
								<OPTION value = "csc">B.A. Computer Science</OPTION>
								<OPTION value = "mat">B.A. Mathematics</OPTION>
								<OPTION value = "cis">B.S. Computer Information Systems</OPTION>
								<OPTION value = "other">Other</OPTION>
							</SELECT>
						</p>
						<p><label for = "second-major-select">Second Major:</label></p>
						<p>
							<SELECT name = "second-major" id = "second-major-select">
								<OPTION value = "csc">B.A. Computer Science</OPTION>
								<OPTION value = "mat">B.A. Mathematics</OPTION>
								<OPTION value = "cis">B.S. Computer Information Systems</OPTION>
								<OPTION value = "none" SELECTED>None</OPTION>
								<OPTION value = "other">Other</OPTION>
							</SELECT>
						</p>
						<p><label for = "minor-select">Minor:</label></p>
						<p>
							<SELECT name = "minor" id = "minor-select">
								<OPTION value = "csc">B.A. Computer Science</OPTION>
								<OPTION value = "mat">B.A. Mathematics</OPTION>
								<OPTION value = "cis">B.S. Computer Information Systems</OPTION>
								<OPTION value = "none" SELECTED>None</OPTION>
								<OPTION value = "other">Other</OPTION>
							</SELECT>
						</p>
						<p><label for = "graduation-select">Planned Graduation:</label></p>
						<p>
							<SELECT name = "graduation" id = "graduation-select">
								<OPTION value = "1">Spring 2015 (Senior)</OPTION>
								<OPTION value = "2">Fall 2015</OPTION>
								<OPTION value = "3">Spring 2016 (Junior)</OPTION>
								<OPTION value = "4">Fall 2016</OPTION>
								<OPTION value = "5">Spring 2017 (Sophmore)</OPTION>
								<OPTION value = "6">Fall 2017</OPTION>
								<OPTION value = "7">Spring 2018 (Freshman)</OPTION>
								<OPTION value = "8">Fall 2018</OPTION>
								<OPTION value = "9">Spring 2019 (Freshman in 5-year)</OPTION>
							</SELECT>
						</p>
						<p><label for = "course-box">Planned Courses:</label></p>
						<p><table name = "courses-plans" id = "course-box-plans" >
                            <thead>
                                <tr>
                                <td>Course Area</td>
                                <td>Course Number</td>
                                <td>Title</td>    
                                <td>(Y/N) Counts for Credit</td>
                                <td>Credits</td>
                                <td>Grade</td>
                                <td>Delete</td>
                                </tr>
                        </thead>
                                <tbody>
                                    <tr>
                                    <td><select class='courseAreaBox' onchange="updateRow()" ></select></td>
                                    <td><select class='courseNumberBox' onchange="updateTitle()"></select></td>
                                    <td></td>
                                    <td><select class='tfForCreditBox'><option value='T'>T</option><option value='F'>F</option></select></td>
                                    <td><input type ='number' min='0' class='creditNumBox' value=''></td>
                                    <td><select class='gradeSelectionBox'><option value='A'>A</option><option value='A-'>A-</option><option value='B+'>B+</option><option value='B'>B</option><option value='B-'>B-</option><option value='C+'>C+</option><option value='C'>C</option><option value='C-'>C-</option><option value="D+">D+</option><option value="D">D</option><option value='F'>F</option><option value='P'>P</option><option value='W'>W</option><option value='WA'>WA</option><option value='WF'>WF</option><option value='WIP'>WIP</option><option value='Transfer'>Transfer</option></select></td>
                                    <td><input type='button' value='delete' onclick='removeRowPlans(this)'></td>
                                    </tr>
                                    
                                    <tr><td colspan='7'><input type='button' value='Add another class' style='width:100%; height:50px;' onclick='addAnotherRowPlans()'></td></tr>
                                </tbody>
                        </table>
                        </p>
						<p><label for = "suggestion-box">Suggestions/Warnings:</label></p>
						<!--<p><TEXTAREA name = "suggestions" id = "suggestion-box" rows = "10" cols = "50"></TEXTAREA></p>-->
						<div id = "suggestion-box">
							<SPAN STYLE = "color:#000000;font-weight:bold;">Information will appear here.  Note: If you're using certain older browsers, it may not appear properly.<BR>
							<!--Information will appear here.<BR>
							Information will appear here.<BR>
							Information will appear here.<BR>
							Information will appear here.<BR>
							Information will appear here.<BR>
							Information will appear here.<BR>
							Information will appear here.<BR>-->
						</div>
						<p><input type = "button" value = "Get Advice!" onClick = "generateReport()"></p>
					</div>
					<div id = "courseHistoryTblCell">
						<p><label for = "course-history-box">Course History:</label></p>
						<p><table name = "course-history" id = "course-history-box" >
                            <thead>
                                <tr>
                                <td>Course Area</td>
                                <td>Course Number</td>
                                <td>Title</td>    
                                <td>(Y/N) Counts for Credit</td>
                                <td>Credits</td>
                                <td>Grade</td>
                                <td>Delete</td>
                                </tr>
                        </thead>
                                <tbody>
                                    <tr>
                                    <td><select class='courseAreaBox' onchange="updateRow()" ></select></td>
                                    <td><select class='courseNumberBox' onchange="updateTitle()"></select></td>
                                    <td></td>
                                    <td><select class='tfForCreditBox'><option value='T'>T</option><option value='F'>F</option></select></td>
                                    <td><input type ='number' min='0' class='creditNumBox' value=''></td>
                                    <td><select class='gradeSelectionBox'><option value='A'>A</option><option value='A-'>A-</option><option value='B+'>B+</option><option value='B'>B</option><option value='B-'>B-</option><option value='C+'>C+</option><option value='C'>C</option><option value='C-'>C-</option><option value="D+">D+</option><option value="D">D</option><option value='F'>F</option><option value='P'>P</option><option value='W'>W</option><option value='WA'>WA</option><option value='WF'>WF</option><option value='WIP'>WIP</option><option value='Transfer'>Transfer</option></select></td>
                                    <td><input type='button' value='delete' onclick='removeRow(this)'></td>
                                    </tr>
                                    
                                    <tr><td colspan='7'><input type='button' value='Add another class' style='width:100%; height:50px;' onclick='addAnotherRow()'></td></tr>
                                </tbody>
                        </table></p>
					</div>
				</div>
			</div>
		</form>
            
            
            
		<script type= 'text/javascript'>
            
var LASString = getLASString();
            
            var tableClasses = document.getElementById('course-history-box');
            var plansTable = document.getElementById('course-box-plans');
            var typicalRow;
            var typicalPlanRow;
            var newClass;
            var masterArray = [];
            var lasArray = LASString.split('\n');
            var currentSelectedSubject;
            var currentSubject = '';
            for(a = 0; a < lasArray.length; a++){
                var line = lasArray[a];
                var commaDivider = line.split(',');
                if(commaDivider[0].split('  ')[0] != currentSubject){
                    currentSubject = commaDivider[0].split('  ')[0];
                    
                    var newSubject = {
                        title:currentSubject,
                        classesArray:[]
                    };
                    masterArray[masterArray.length] = newSubject;
                    
                }
                newClass = {
                    subject:currentSubject,
                    classNumber:commaDivider[0].split('  ')[1],
                    classTitle:commaDivider[1]
                    
                }
                
                masterArray[masterArray.length - 1].classesArray[masterArray[masterArray.length -1].classesArray.length] = newClass;
                
            }
            
            for(p = 0; p < masterArray.length; p++){
                
                for(a = 1; a < tableClasses.rows.length -1; a++){
                    var currentRow = tableClasses.rows[a];
                    var titleCellNow = currentRow.getElementsByTagName('TD')[2];
                    
                    var x = document.createElement("OPTION");
                        x.setAttribute("value", p);
                        x.text = masterArray[p].title;                   
                    currentRow.getElementsByClassName('courseAreaBox')[0].add(x);
 
                    
                    
                }
                
                for(a = 1; a < plansTable.rows.length -1; a++){
                    var currentRow = plansTable.rows[a];
                    var titleCellNow = currentRow.getElementsByTagName('TD')[2];
                    
                    var x = document.createElement("OPTION");
                        x.setAttribute("value", p);
                        x.text = masterArray[p].title;                   
                    currentRow.getElementsByClassName('courseAreaBox')[0].add(x);
 
                    
                    
                }
                
            }
            typicalRow = document.getElementById('course-history-box').rows[1];
            typicalPlanRow = plansTable.rows[1];
            
            
            for(a = 1; a < tableClasses.rows.length -1; a++){
                    var currentRow = tableClasses.rows[a];
                    var titleCellNow = currentRow.getElementsByTagName('TD')[2];
                    
    
                    var theindexMatch = currentRow.getElementsByClassName('courseAreaBox')[0].value;
                    
                    if(theindexMatch != -1){
                        var currentClassesArray = masterArray[theindexMatch].classesArray;
                        for(i = 0; i < currentClassesArray.length; i++){
                            
                            var x = document.createElement("OPTION");
                            x.setAttribute("value", i);
                            x.text = currentClassesArray[i].classNumber;
                    
                            currentRow.getElementsByClassName('courseNumberBox')[0].add(x);
                            }
                        
                        
                        
                    }else{
                        console.log('silliness at row ' + (a-1));
                    }
                    titleCellNow.innerHTML = masterArray[theindexMatch].classesArray[currentRow.getElementsByClassName('courseNumberBox')[0].value].classTitle;
                                        
                    
            }
            

            for(a = 1; a < plansTable.rows.length -1; a++){
                    var currentRow = plansTable.rows[a];
                    var titleCellNow = currentRow.getElementsByTagName('TD')[2];
                    
    
                    var theindexMatch = currentRow.getElementsByClassName('courseAreaBox')[0].value;
                    
                    if(theindexMatch != -1){
                        var currentClassesArray = masterArray[theindexMatch].classesArray;
                        for(i = 0; i < currentClassesArray.length; i++){
                            
                            var x = document.createElement("OPTION");
                            x.setAttribute("value", i);
                            x.text = currentClassesArray[i].classNumber;
                    
                            currentRow.getElementsByClassName('courseNumberBox')[0].add(x);
                            }
                        
                        
                        
                    }else{
                        console.log('silliness at row ' + (a-1));
                    }
                    titleCellNow.innerHTML = masterArray[theindexMatch].classesArray[currentRow.getElementsByClassName('courseNumberBox')[0].value].classTitle;
                                        
                    
            }            
           
            function removeRow(src)
            {
                /* src refers to the input button that was clicked. 
                to get a reference to the containing <tr> element,
                get the parent of the parent (in this case <tr>)
                */   
                var oRow = src.parentElement.parentElement;  
    
                //once the row reference is obtained, delete it passing in its rowIndex   
                tableClasses.deleteRow(oRow.rowIndex);  

            }
            
            function addAnotherRowPlans(){
                var newRow = plansTable.insertRow(plansTable.rows.length -1);
                for(z = 0; z< typicalPlanRow.cells.length; z++){
                    var tempCell = newRow.insertCell(z);
                    tempCell.innerHTML = typicalPlanRow.cells[z].innerHTML;
                }
                
            
            }
            
            function removeRowPlans(src)
            {
                /* src refers to the input button that was clicked. 
                to get a reference to the containing <tr> element,
                get the parent of the parent (in this case <tr>)
                */   
                
                var oRow = src.parentElement.parentElement;  
    
                //once the row reference is obtained, delete it passing in its rowIndex   
                plansTable.deleteRow(oRow.rowIndex);  
                            

            }
            
            function addAnotherRow(){
                var newRow = tableClasses.insertRow(tableClasses.rows.length -1);
                for(z = 0; z< typicalRow.cells.length; z++){
                    var tempCell = newRow.insertCell(z);
                    tempCell.innerHTML = typicalRow.cells[z].innerHTML;
                }
                
            
            }            
            
            function updateRow(){
                var arrayOFTitles = [];
                for(a = 1; a < tableClasses.rows.length -1; a++){
                    var currentRow = tableClasses.rows[a];
                   
                    var courseAreaBox = currentRow.getElementsByClassName('courseAreaBox')[0];
                    var courseNumBox = currentRow.getElementsByClassName('courseNumberBox')[0];
                    var tfCreditBox = currentRow.getElementsByClassName('tfForCreditBox')[0];
                    var creditNumBox = currentRow.getElementsByClassName('creditNumBox')[0];
                    var gradeSelectionBox = currentRow.getElementsByClassName('gradeSelectionBox')[0];
                    var titleCell = currentRow.getElementsByTagName('TD')[2];
                    var numLength = courseNumBox.options.length;

                    courseNumBox.options.length = 0;
                    
                    var theCoursesArray = masterArray[courseAreaBox.value].classesArray;
                    
                    for(p = 0; p < theCoursesArray.length; p++){
                        var newOption = document.createElement("OPTION");
                            newOption.setAttribute("value", p);
                            newOption.text = theCoursesArray[p].classNumber;   
                    
                            courseNumBox.options.add(newOption);
                    }
                    
                }//updates history table
                
                for(a = 1; a < plansTable.rows.length -1; a++){
                    var currentRow = plansTable.rows[a];
                   
                    var courseAreaBox = currentRow.getElementsByClassName('courseAreaBox')[0];
                    var courseNumBox = currentRow.getElementsByClassName('courseNumberBox')[0];
                    var tfCreditBox = currentRow.getElementsByClassName('tfForCreditBox')[0];
                    var creditNumBox = currentRow.getElementsByClassName('creditNumBox')[0];
                    var gradeSelectionBox = currentRow.getElementsByClassName('gradeSelectionBox')[0];
                    var titleCell = currentRow.getElementsByTagName('TD')[2];
                    var numLength = courseNumBox.options.length;

                    courseNumBox.options.length = 0;
                    
                    var theCoursesArray = masterArray[courseAreaBox.value].classesArray;
                    
                    for(p = 0; p < theCoursesArray.length; p++){
                        var newOption = document.createElement("OPTION");
                            newOption.setAttribute("value", p);
                            newOption.text = theCoursesArray[p].classNumber;   
                    
                            courseNumBox.options.add(newOption);
                    }
                    
                }//updates academic plans table                
                
                updateTitle();   
            
            }
            
            function updateTitle(){

                for(a = 1; a < tableClasses.rows.length -1; a++){
                    var currentRow = tableClasses.rows[a];
                   
                    var courseAreaBox = currentRow.getElementsByClassName('courseAreaBox')[0];
                    var courseNumBox = currentRow.getElementsByClassName('courseNumberBox')[0];
                    var titleCell = currentRow.getElementsByTagName('TD')[2];
                    var numLength = courseNumBox.options.length;
                    titleCell.innerHTML = masterArray[courseAreaBox.value].classesArray[courseNumBox.value].classTitle;
                    
                }//updating all titles in Course History
                
                
                for(a = 1; a < plansTable.rows.length -1; a++){
                    var currentRow = plansTable.rows[a];
                   
                    var courseAreaBox = currentRow.getElementsByClassName('courseAreaBox')[0];
                    var courseNumBox = currentRow.getElementsByClassName('courseNumberBox')[0];
                    var titleCell = currentRow.getElementsByTagName('TD')[2];
                    var numLength = courseNumBox.options.length;
                    titleCell.innerHTML = masterArray[courseAreaBox.value].classesArray[courseNumBox.value].classTitle;
                    
                } //updating all title is Academic Plans               
                
                
            }
            
			function generateReport()
			{
                var allComplete = true;
                for(i = 0; i < document.getElementsByClassName('courseAreaBox').length; i++){
                    
                    var currentBox = document.getElementsByClassName('courseAreaBox')[i];
                    if(currentBox.value == ''){
                        console.log('Failed courseArea');
                        allComplete = false;
                    }                    
                }
                for(i = 0; i < document.getElementsByClassName('courseNumberBox').length; i++){
                    var currentBox = document.getElementsByClassName('courseNumberBox')[i];
                                        
                    if(currentBox.value == ''){
                        console.log('Failed Course Number');
                        allComplete = false;
                    }                    
                }
                for(i = 0; i < document.getElementsByClassName('tfForCreditBox').length; i++){
                    var currentBox = document.getElementsByClassName('tfForCreditBox')[i];
                    if(currentBox.value == ''){
                        console.log('Failed T/F');
                        allComplete = false;
                    }                    
                }
                for(i = 0; i < document.getElementsByClassName('creditNumBox').length; i++){
                    var currentBox = document.getElementsByClassName('creditNumBox')[i];
                    if(currentBox.value == ''){
                        console.log('Failed Credit Num');
                        allComplete = false;
                    }                    
                }
                for(i = 0; i < document.getElementsByClassName('gradeSelectionBox').length; i++){
                    var currentBox = document.getElementsByClassName('gradeSelectionBox')[i];
                    if(currentBox.value == ''){
                        console.log('Failed grade selection');
                        allComplete = false;
                    }                    
                }                
                console.log('allComplete: ' + allComplete);
                if(!allComplete){
                    alert('You left at least one entry field blank');
                }else{
                
                var classesArray = [];
                    
                for(a = 1; a < tableClasses.rows.length -1; a++){
                    var currentRow = tableClasses.rows[a];
                   
                    var courseAreaBox = currentRow.getElementsByClassName('courseAreaBox')[0];
                    var courseNumBox = currentRow.getElementsByClassName('courseNumberBox')[0];
                    var tfCreditBox = currentRow.getElementsByClassName('tfForCreditBox')[0];
                    var creditNumBox = currentRow.getElementsByClassName('creditNumBox')[0];
                    var gradeSelectionBox = currentRow.getElementsByClassName('gradeSelectionBox')[0];
                    console.log('adding coursearea ' + courseAreaBox.value + ' adding numbox ' + courseNumBox.options[courseNumBox.value].text + ' tf credit ' + tfCreditBox.value + ' credit ' + creditNumBox.value + ' grade ' + gradeSelectionBox.value);
                    var tempClass = [courseAreaBox.options[courseAreaBox.value].text, courseNumBox.options[courseNumBox.value].text, tfCreditBox.value, creditNumBox.value, gradeSelectionBox.value];
                    classesArray[classesArray.length] = tempClass;
                }
                    
                    
                    
                var classesPlannedArray = [];// array of data from academic plans table
                    
                for(a = 1; a < plansTable.rows.length -1; a++){
                    var currentRow = plansTable.rows[a];
                   
                    var courseAreaBox = currentRow.getElementsByClassName('courseAreaBox')[0];
                    var courseNumBox = currentRow.getElementsByClassName('courseNumberBox')[0];
                    var tfCreditBox = currentRow.getElementsByClassName('tfForCreditBox')[0];
                    var creditNumBox = currentRow.getElementsByClassName('creditNumBox')[0];
                    var gradeSelectionBox = currentRow.getElementsByClassName('gradeSelectionBox')[0];
                    console.log('adding coursearea ' + courseAreaBox.value + ' adding numbox ' + courseNumBox.options[courseNumBox.value].text + ' tf credit ' + tfCreditBox.value + ' credit ' + creditNumBox.value + ' grade ' + gradeSelectionBox.value);
                    var tempClass = [courseAreaBox.options[courseAreaBox.value].text, courseNumBox.options[courseNumBox.value].text, tfCreditBox.value, creditNumBox.value, gradeSelectionBox.value];
                    classesPlannedArray[classesPlannedArray.length] = tempClass;
                }                    
                    
                
                var courseInput = {
					courseHistory:classesArray,
					semestersToGraduate:document.getElementById('graduation-select').value,
					firstMajor:document.getElementById('first-major-select').value,
					secondMajor:document.getElementById('second-major-select').value,
					minor:document.getElementById('minor-select').value
				};
				var responseItems = generateAdvice(courseInput);
				//var responseItems = parseCourseHistory(courseHistory);
				var responseHTML = "<ol>\n";
				for(var i = 0; i < responseItems.length;i++)
				{
					var responseItem = responseItems[i];
					if(responseItem)
						responseHTML += "\t<li>" + responseItem + "</li>\n";
				}
				responseHTML += "</ol>";
				document.getElementById('suggestion-box').innerHTML = responseHTML;
				//alert(responseHTML);
				//parseCourseHistory(document.getElementById('course-history-box').value);
							/*var courseHistory = document.getElementById('course-history-box').value;
				var semestersToGraduate = document.getElementById('graduation-select').value;
				var firstMajor = document.getElementById('first-major-select').value;
				var secondMajor = document.getElementById('second-major-select').value;
				var minor = document.getElementById('minor-select').value;   
                    
                }
                

                
                		var courseItem = {
			courseAreaCode:  courseInfo[0],
			courseNumber:    courseInfo[1],
			countsForCredit: courseInfo.indexOf("Credit") != -1 || courseInfo.indexOf("Transfer") != -1,
			credits:         getMatch(courseInfo, /[0-9][.][0-9][0-9]/),
			grade:           getCommonElement(courseInfo, grades)
		};*/
            
            }
            }
		</script>            
            
	</body>
</html>
